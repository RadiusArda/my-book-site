
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Lecture 3: Linear Regression with Continues Dependent Variable and Multiple Independent Variables &#8212; Edinburgh Data Project</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Lecture 4: Logistic Regression with Binary Dependent Variable and Multiple Independent Variables" href="Lecture4.html" />
    <link rel="prev" title="Lecture 2: Measures for Association in Categorical Data" href="Lecture2.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Edinburgh Data Project</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Introduciton to Political Data Analysis: Python tutorials
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Lecture1.html">
   Lecture 1: T-Test and ANOVA
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Lecture2.html">
   Lecture 2: Measures for Association in Categorical Data
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Lecture 3: Linear Regression with Continues Dependent Variable and Multiple Independent Variables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Lecture4.html">
   Lecture 4: Logistic Regression with Binary Dependent Variable and Multiple Independent Variables
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/Lecture3.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/bardas97/my-book-site/master?urlpath=tree/Lecture3.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#importing-dataset-libraries-and-data-organization">
   1- Importing Dataset, Libraries and Data Organization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#variables">
   2- Variables
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#descriptive-graphs">
   3- Descriptive Graphs
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#linear-regression">
   4- Linear Regression
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#interactive-linear-regression-widgets">
   5- Interactive Linear Regression Widgets
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="lecture-3-linear-regression-with-continues-dependent-variable-and-multiple-independent-variables">
<h1>Lecture 3: Linear Regression with Continues Dependent Variable and Multiple Independent Variables<a class="headerlink" href="#lecture-3-linear-regression-with-continues-dependent-variable-and-multiple-independent-variables" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<section id="importing-dataset-libraries-and-data-organization">
<h2>1- Importing Dataset, Libraries and Data Organization<a class="headerlink" href="#importing-dataset-libraries-and-data-organization" title="Permalink to this headline">¶</a></h2>
<br>
<br>
<font face="Helvetica" size="3.5px" color="#323752">In this lecture we will be working on, univariate descriptive statistics and graphics, some bivariate analysis and multivariate, continues dependent variable, linear regression. </font><br>
<br>
<font face="Helvetica" size="3.5px" color="#323752">As always we will import some funtions that will be used throughout the tutorial. <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">operator</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">stats</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">chi2_contingency</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">chi2</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span>
<span class="kn">import</span> <span class="nn">random</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ipykernel_64664</span><span class="o">/</span><span class="mf">1852491550.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="kn">import</span> <span class="nn">warnings</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;numpy&#39;
</pre></div>
</div>
</div>
</div>
<br>
<br>
<font face="Helvetica" size="3px" color="#323752" >We do not want to see undesired warnings in our report.</font>
<br>
<br><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<br>
<br>
<font face="Helvetica" size="3px" color="#323752" >In the following code cell we will create a function to hide/show code cells. Since some of the code cells that we will create in this tutorial is quite long especially the ones for the widgets. We will call this function inside the cells.</font>
<br>
<br><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#data = pd.read_csv(r&#39;anes_data.csv&#39;)</span>
<span class="c1">#data.info()</span>
</pre></div>
</div>
</div>
</div>
<br>
<br>
<font face="Helvetica" size="3px" color="#323752" >Our dataset columns has code names for variables. We will change the names in oder to simplify the understanding.</font>
<br>
<br><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#data = data.rename(columns={&#39;V201152&#39;: &#39;Thermo_republican&#39;})</span>
<span class="c1">#data = data.rename(columns={&#39;V202637&#39;: &#39;gender&#39;})</span>
<span class="c1">#data = data.rename(columns={&#39;V201507x&#39;: &#39;age&#39;})</span>
<span class="c1">#data = data.rename(columns={&#39;V201234&#39;: &#39;government&#39;})</span>
<span class="c1">#data = data.rename(columns={&#39;V201237&#39;: &#39;interTrust&#39;})</span>
<span class="c1">#data = data.rename(columns={&#39;V201352&#39;: &#39;elecTrust&#39;})</span>
<span class="c1">#data = data.rename(columns={&#39;V201435&#39;: &#39;religion&#39;})</span>
<span class="c1">#data = data.rename(columns={&#39;V201433&#39;: &#39;relImportance&#39;})</span>
<span class="c1">#data = data.rename(columns={&#39;V201436&#39;: &#39;newReligion&#39;})</span>
</pre></div>
</div>
</div>
</div>
<br>
<br>
<font face="Helvetica" size="3px" color="#323752">After changing their names, let's get familiar with the variables.</font>
<br>
<br></section>
<section id="variables">
<h2>2- Variables<a class="headerlink" href="#variables" title="Permalink to this headline">¶</a></h2>
<br>
<font face="Helvetica"  size="4px" color="#323752" > <b> 1) Thermo_republican: Thermometer toward the republican candidate</b> </font><br>
<font face="Helvetica" size="3px" color="#323752">This varible determines the feeling toward the candidate of republicans. This variable ranges from 0-100, we will treat it as a continuous variable. Thermo_republican will be our dependent variable in this tutorial.</font>
<br><br>
<font face="Helvetica"  size="4px" color="#323752" > <b> 2) Gender</b> </font><font face="Helvetica" size="3px" color="#323752">
1. Male
<br>
2. Female<br>
<font face="Helvetica"  size="4px" color="#323752" > <b> 3) Age</b> </font><br>
<font face="Helvetica"  size="4px" color="#323752" > <b> 4) Government: Government run by a few</b> </font><br>
<font face="Helvetica" size="3px" color="#323752">The question is : Would you say the government is pretty much run by a few
big interests looking out for themselves or that it is run for the benefit of all the people?
<br> 1. Run by a few big interests
<br> 2. For the benefit of all the people
</font><br>
<font face="Helvetica"  size="4px" color="#323752" > <b> 5) InterTrust: Interpersonal trust</b> </font><br>
<font face="Helvetica" size="3px" color="#323752">The question is : Generally speaking, how often can you trust other people?
<br>1. Always
<br>2. Most of the time
<br>3. About half the time
<br>4. Some of the time
<br>5. Never
<br><br>
<font face="Helvetica"  size="4px" color="#323752" > <b> 6) ElecTrust: Election officials trust</b> </font><br>
<font face="Helvetica" size="3px" color="#323752">The question is : How much do you trust the officials who oversee elections
where you live?
<br>1. Not at all
<br>2. A little
<br>3. A moderate amount
<br>4. A lot
<br>5. A great deal
<br><br>
<font face="Helvetica"  size="4px" color="#323752" > <b> 7) Religion</b> </font><br>
<font face="Helvetica" size="3px" color="#323752">The question is : What is your present religion, if any?
<br>1. Protestant
<br>2. Roman Catholic
<br>3. Orthodox Christian (such as Greek or Russian Orthodox)
<br>4. Latter-Day Saints (LDS)
<br>5. Jewish
<br>6. Muslim
<br>7. Buddhist
<br>8. Hindu
<br>9. Atheist
<br>10. Agnostic
<br>11. Something else
<br>12. Nothing in particular
<br><br>
<font face="Helvetica"  size="4px" color="#323752" > <b> 8) RelImportance : Importance of religion</b> </font><br>
<font face="Helvetica" size="3px" color="#323752">The question is :How important is religion in your life?
<br>1. Extremely important
<br>2. Very important
<br>3. Moderately important
<br>4. A little important
<br>5. Not important at all
<br><br>
<font face="Helvetica"  size="4px" color="#323752" > <b> 9) NewReligion : A new variable</b> </font><br>
<font face="Helvetica" size="3px" color="#323752"> This is a binary variable to control for protestants for whom religion is either extremely important or very important which is created by using variables <b>religion</b> and <b>relImportance</b>.
<br>
1. Protestant and religion is extremely important or veryimportant.  
<br>
2. Either protestant but religion is not important part of life not or not a protestant.   <br>
<br>
<font face="Helvetica" size="3px" color="#323752" >We need to get rid of the unnecessary variables to shrink the data, which has 1771 different variables (column entries). You can see the latest format of the dataset in the output below.</font>
<br>
<br><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#data2 = data[[&#39;Thermo_republican&#39;,&#39;gender&#39;,&#39;age&#39;,&#39;government&#39;,&#39;interTrust&#39;,&#39;elecTrust&#39;, &#39;religion&#39;, &#39;relImportance&#39;, &#39;newReligion&#39;]]</span>

<span class="c1">#data2.to_csv(&quot;data2.csv&quot;)</span>
<span class="n">data2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;data2.csv&#39;</span><span class="p">)</span>
<span class="n">data2</span> <span class="o">=</span> <span class="n">data2</span><span class="p">[[</span><span class="s1">&#39;Thermo_republican&#39;</span><span class="p">,</span><span class="s1">&#39;gender&#39;</span><span class="p">,</span><span class="s1">&#39;age&#39;</span><span class="p">,</span><span class="s1">&#39;government&#39;</span><span class="p">,</span><span class="s1">&#39;interTrust&#39;</span><span class="p">,</span><span class="s1">&#39;elecTrust&#39;</span><span class="p">,</span> <span class="s1">&#39;religion&#39;</span><span class="p">,</span> <span class="s1">&#39;relImportance&#39;</span><span class="p">,</span> <span class="s1">&#39;newReligion&#39;</span><span class="p">]]</span>
<span class="n">data2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Thermo_republican</th>
      <th>gender</th>
      <th>age</th>
      <th>government</th>
      <th>interTrust</th>
      <th>elecTrust</th>
      <th>religion</th>
      <th>relImportance</th>
      <th>newReligion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>100</td>
      <td>-1</td>
      <td>46</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>11</td>
      <td>2</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>-1</td>
      <td>37</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
      <td>12</td>
      <td>5</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>-1</td>
      <td>40</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
      <td>11</td>
      <td>3</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15</td>
      <td>-1</td>
      <td>41</td>
      <td>1</td>
      <td>2</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>85</td>
      <td>-1</td>
      <td>72</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
      <td>12</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>8275</th>
      <td>100</td>
      <td>2</td>
      <td>26</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
      <td>11</td>
      <td>3</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>8276</th>
      <td>70</td>
      <td>2</td>
      <td>52</td>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>4</td>
      <td>1</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>8277</th>
      <td>30</td>
      <td>-1</td>
      <td>45</td>
      <td>1</td>
      <td>4</td>
      <td>3</td>
      <td>2</td>
      <td>3</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>8278</th>
      <td>100</td>
      <td>-1</td>
      <td>65</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>8279</th>
      <td>0</td>
      <td>2</td>
      <td>38</td>
      <td>1</td>
      <td>2</td>
      <td>4</td>
      <td>7</td>
      <td>3</td>
      <td>-1</td>
    </tr>
  </tbody>
</table>
<p>8280 rows × 9 columns</p>
</div></div></div>
</div>
<br>
<br>
<font face="Helvetica" size="3px" color="#323752" > Before starting the calculations, we need to cleanse the data set. Since missing informations are determined, we need to get rid of them. For instance, a missing information in Thermometer data is given with negative values. Therefore, we need to handle them to have more accurate result.</font>.<br>
<font face="Helvetica" size="3px" color="#323752" > Also, we will create a new binary varible that controls respondent is either an extremely religous or very religious protestant. If respondents is one of them, the label will be one.<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data2</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">])):</span>
    <span class="k">if</span> <span class="n">data2</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">data2</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data2</span><span class="p">[</span><span class="s1">&#39;religion&#39;</span><span class="p">])):</span>
    <span class="k">if</span> <span class="n">data2</span><span class="p">[</span><span class="s1">&#39;religion&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">data2</span><span class="p">[</span><span class="s1">&#39;relImportance&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">data2</span><span class="p">[</span><span class="s1">&#39;relImportance&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
            <span class="n">data2</span><span class="p">[</span><span class="s1">&#39;newReligion&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data2</span><span class="p">[</span><span class="s1">&#39;newReligion&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data2</span><span class="p">[</span><span class="s1">&#39;newReligion&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data2</span><span class="p">[</span><span class="s1">&#39;Thermo_republican&#39;</span><span class="p">])):</span>
    <span class="k">if</span> <span class="n">data2</span><span class="p">[</span><span class="s1">&#39;Thermo_republican&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">data2</span><span class="p">[</span><span class="s1">&#39;Thermo_republican&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">data2</span><span class="p">[</span><span class="s1">&#39;Thermo_republican&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<br>
<br>
<font face="Helvetica" size="3px" color="#323752" > Now, we can examine the clear format.</font>.<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Thermo_republican</th>
      <th>gender</th>
      <th>age</th>
      <th>government</th>
      <th>interTrust</th>
      <th>elecTrust</th>
      <th>religion</th>
      <th>relImportance</th>
      <th>newReligion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>100</td>
      <td>1</td>
      <td>46</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>11</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1</td>
      <td>37</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
      <td>12</td>
      <td>5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>1</td>
      <td>40</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
      <td>11</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15</td>
      <td>1</td>
      <td>41</td>
      <td>1</td>
      <td>2</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>85</td>
      <td>1</td>
      <td>72</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
      <td>12</td>
      <td>4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>8275</th>
      <td>100</td>
      <td>2</td>
      <td>26</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
      <td>11</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8276</th>
      <td>70</td>
      <td>2</td>
      <td>52</td>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>4</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8277</th>
      <td>30</td>
      <td>1</td>
      <td>45</td>
      <td>1</td>
      <td>4</td>
      <td>3</td>
      <td>2</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8278</th>
      <td>100</td>
      <td>1</td>
      <td>65</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8279</th>
      <td>0</td>
      <td>2</td>
      <td>38</td>
      <td>1</td>
      <td>2</td>
      <td>4</td>
      <td>7</td>
      <td>3</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>8280 rows × 9 columns</p>
</div></div></div>
</div>
<br>
<br>
<font face="Helvetica" size="3px" color="#323752" >Let's calculate the univarite stats of the each variable. We will use <b>describe()</b> function of the pandas dataframe.</font><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data2</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Thermo_republican</th>
      <th>gender</th>
      <th>age</th>
      <th>government</th>
      <th>interTrust</th>
      <th>elecTrust</th>
      <th>religion</th>
      <th>relImportance</th>
      <th>newReligion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>8280.000000</td>
      <td>8280.000000</td>
      <td>8280.000000</td>
      <td>8280.000000</td>
      <td>8280.000000</td>
      <td>8280.000000</td>
      <td>8280.000000</td>
      <td>8280.000000</td>
      <td>8280.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>40.408575</td>
      <td>0.229589</td>
      <td>49.038889</td>
      <td>1.031763</td>
      <td>2.785266</td>
      <td>3.324638</td>
      <td>6.046014</td>
      <td>2.759179</td>
      <td>0.180193</td>
    </tr>
    <tr>
      <th>std</th>
      <td>39.742611</td>
      <td>2.223543</td>
      <td>20.771267</td>
      <td>1.162830</td>
      <td>1.061931</td>
      <td>1.432433</td>
      <td>4.942714</td>
      <td>1.652934</td>
      <td>0.384372</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>-8.000000</td>
      <td>-9.000000</td>
      <td>-9.000000</td>
      <td>-9.000000</td>
      <td>-9.000000</td>
      <td>-9.000000</td>
      <td>-9.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>35.000000</td>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>3.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>30.000000</td>
      <td>1.000000</td>
      <td>51.000000</td>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>3.000000</td>
      <td>5.000000</td>
      <td>3.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>85.000000</td>
      <td>1.000000</td>
      <td>65.000000</td>
      <td>1.000000</td>
      <td>4.000000</td>
      <td>4.000000</td>
      <td>11.000000</td>
      <td>4.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>100.000000</td>
      <td>2.000000</td>
      <td>80.000000</td>
      <td>2.000000</td>
      <td>5.000000</td>
      <td>5.000000</td>
      <td>12.000000</td>
      <td>5.000000</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<br>
<br>
<font face="Helvetica" size="3px" color="#323752" >Another operation that might be applied to these varibles is observing their correlations between them. In order to do that, we will use the heatmap funtion of seaborn library</font>.<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">data2</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">annot</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdYlGn_r&#39;</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">data2</span><span class="o">.</span><span class="n">corr</span><span class="p">())));</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Correlations between factors&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Lecture3_41_0.png" src="_images/Lecture3_41_0.png" />
</div>
</div>
<br>
<br>
<font face="Helvetica" size="3px" color="#323752" >As shown in the heatmap, some of the variables have positive correlations while some of them have negative. Positive correlation means that while one of the variables is increasing the other one increases as well. In negative correlation, while one of the variables is increasing the other one decreases</font>.</section>
<section id="descriptive-graphs">
<h2>3- Descriptive Graphs<a class="headerlink" href="#descriptive-graphs" title="Permalink to this headline">¶</a></h2>
<br>
<br>
<font face="Helvetica" size="3px" color="#323752">In this part, we will plot some of the independent varibles, their distributions, probability density functions and also bivariate relations between them. We will start with Kernel Density Estimation (KDE) of our dependet variable. Kernel Density Estimation (KDE) is a way to estimate the probability density function of a continuous random variable</font>.<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data2</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Thermo_republican&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Thermometer toward the republican candidate (PDF)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Lecture3_45_0.png" src="_images/Lecture3_45_0.png" />
</div>
</div>
<br>
<font face="Helvetica" size="3px" color="#323752">We can say that general approach is not positive toward the republician candidate. Let's continue with the independent variables. In this part <b>histograms</b> will be used to show the results. Labels are given in the variable section.
<br><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data2</span><span class="p">[</span><span class="s1">&#39;interTrust&#39;</span><span class="p">],</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;percent&quot;</span><span class="p">,</span><span class="n">binrange</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">data2</span><span class="p">[</span><span class="s1">&#39;interTrust&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span>  <span class="n">discrete</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;axes.grid&#39;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Interpersonal Trust&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Interpersonal Trust Labels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Lecture3_47_0.png" src="_images/Lecture3_47_0.png" />
</div>
</div>
<br>
<font face="Helvetica" size="3px" color="#323752">The most common answer to interpersonal trust question is <b>2. Most of the time.</b> Second parameter is age.<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data2</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">],</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;count&quot;</span><span class="p">,</span><span class="n">binrange</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">data2</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span>  <span class="n">discrete</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;axes.grid&#39;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Age Distributiaon&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Age&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Lecture3_49_0.png" src="_images/Lecture3_49_0.png" />
</div>
</div>
<br>
<font face="Helvetica" size="3px" color="#323752"> 80 years old and older ages are given as 80 in our dataset. Next graph is about election officials trust.<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data2</span><span class="p">[</span><span class="s1">&#39;elecTrust&#39;</span><span class="p">],</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;percent&quot;</span><span class="p">,</span><span class="n">binrange</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">data2</span><span class="p">[</span><span class="s1">&#39;elecTrust&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span>  <span class="n">discrete</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;axes.grid&#39;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Election Officials Trust Distributiaon&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Election Officials Trust Labels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Percentage (%)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Lecture3_51_0.png" src="_images/Lecture3_51_0.png" />
</div>
</div>
<br>
<font face="Helvetica" size="3px" color="#323752"> The most common answers are <b>3. A moderate amount</b> and <b>4. A lot</b>. Next is government run by a few.<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data2</span><span class="p">[</span><span class="s1">&#39;government&#39;</span><span class="p">],</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;percent&quot;</span><span class="p">,</span><span class="n">binrange</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">data2</span><span class="p">[</span><span class="s1">&#39;government&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">2</span><span class="p">],</span>  <span class="n">discrete</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;axes.grid&#39;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Government run by few&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Government run by few Labels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Lecture3_53_0.png" src="_images/Lecture3_53_0.png" />
</div>
</div>
<br>
<font face="Helvetica" size="3px" color="#323752">There is a clear winner, 1. Government is pretty much run by a few big interests looking out for themselves. Next operation will be a regression plot that shows the relation between our new varible that is about protestant religion information and thermometer toward the republican candidate. Before examining the result below, please read the variable section of <b>newReligion</b> again.
<br><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Thermo_republican&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data2</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">.7</span>
            <span class="p">,</span><span class="n">hue</span> <span class="o">=</span> <span class="s1">&#39;newReligion&#39;</span><span class="p">,</span>  <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;percent&quot;</span><span class="p">,</span> <span class="n">discrete</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">binwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">multiple</span><span class="o">=</span><span class="s2">&quot;stack&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;freedom_house&#39;</span><span class="p">);</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;axes.grid&#39;</span> <span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Is the respondant a extremely or very religious protestant? (Yes/No)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Thermometer toward the republican candidate&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Lecture3_55_0.png" src="_images/Lecture3_55_0.png" />
</div>
</div>
</section>
<section id="linear-regression">
<h2>4- Linear Regression<a class="headerlink" href="#linear-regression" title="Permalink to this headline">¶</a></h2>
<br>
<font face="Helvetica" size="3px" color="#323752">In this section, we will learn about the <b> Multiple Linear Regression Model </b> and its implementation in Python.
<br>
<font face="Helvetica" size="3px" color="#323752">Multiple Linear Regression is an extension of Simple Linear regression as it takes more than one predictor variable to predict the response variable. It is an important regression algorithm that models the linear relationship between a single dependent continuous variable and more than one independent variable. It uses two or more independent variables to predict a dependent variable by fitting a best linear relationship.
<br>
It has two or more independent variables (X) and one dependent variable (Y), where Y is the value to be predicted. Thus, it is an approach for predicting a quantitative response using multiple features.
<br><br>
<font face="Helvetica" size="3px" color="#323752">Set the values for independent (X) variable and dependent (Y) variable.<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">data2</span><span class="p">[[</span><span class="s1">&#39;gender&#39;</span><span class="p">,</span><span class="s1">&#39;age&#39;</span><span class="p">,</span><span class="s1">&#39;government&#39;</span><span class="p">,</span><span class="s1">&#39;interTrust&#39;</span><span class="p">,</span>
           <span class="s1">&#39;elecTrust&#39;</span><span class="p">,</span> <span class="s1">&#39;religion&#39;</span><span class="p">,</span> <span class="s1">&#39;relImportance&#39;</span><span class="p">,</span> <span class="s1">&#39;newReligion&#39;</span><span class="p">]]</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">data2</span><span class="p">[</span><span class="s1">&#39;Thermo_republican&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<br>
<font face="Helvetica" size="3px" color="#323752"> Split the dataset into train and test set. <b>train_test_split  </b> is used for splitting data arrays into two subsets: for training data and testing data. With this function, you don’t need to divide the dataset manually. We need to split our dataset into training and testing sets. We’ll perform this by importing train_test_split from the sklearn.model_selection library. It is usually good to keep 75% of the data in your train dataset and the rest 25% in your test dataset.
<br><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">x_train</span><span class="p">,</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<br>
<font face="Helvetica" size="3px" color="#323752"> Implement the linear model. We will use LinearRegression() from sklearn.
<br><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Fitting the Multiple Linear Regression model</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>

<span class="n">mlr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>  
<span class="n">mlr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LinearRegression()
</pre></div>
</div>
</div>
</div>
<br>
<font face="Helvetica" size="3px" color="#323752"> To obtain the regression equation coefficients we will implement the following code.
<br><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Intercept and Coefficient</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Intercept: &quot;</span><span class="p">,</span> <span class="n">mlr</span><span class="o">.</span><span class="n">intercept_</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Coefficients:&quot;</span><span class="p">)</span>
<span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mlr</span><span class="o">.</span><span class="n">coef_</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Intercept:  61.06446327528372
Coefficients:
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;gender&#39;, -0.5694783290983726),
 (&#39;age&#39;, 0.12335737057836153),
 (&#39;government&#39;, 3.3502712826184933),
 (&#39;interTrust&#39;, 0.3218141225170065),
 (&#39;elecTrust&#39;, -5.212525087965339),
 (&#39;religion&#39;, -0.4986582582672586),
 (&#39;relImportance&#39;, -4.610846822140651),
 (&#39;newReligion&#39;, 10.961267990760895)]
</pre></div>
</div>
</div>
</div>
<br>
<font face="Helvetica" size="3px" color="#323752"> Once we have fitted (trained) the model, we can make predictions using the <b>predict()</b> function. We pass the values of x_test to this method and compare the predicted values called y_pred_mlr with y_test values to check how accurate our predicted values are.
<br><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Prediction of test set</span>
<span class="n">y_pred_mlr</span><span class="o">=</span> <span class="n">mlr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="c1">#Predicted values</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Prediction for test set: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">y_pred_mlr</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Prediction for test set: [47.17917471 37.95754948 42.17566438 ... 53.75536376 52.5331664
 34.04949262]
</pre></div>
</div>
</div>
</div>
<br>
<font face="Helvetica" size="3px" color="#323752"> Actual values and the predicted values.
<br><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Actual value and the predicted value</span>
<span class="n">mlr_diff</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Actual value&#39;</span><span class="p">:</span> <span class="n">y_test</span><span class="p">,</span> <span class="s1">&#39;Predicted value&#39;</span><span class="p">:</span> <span class="n">y_pred_mlr</span><span class="p">})</span>
<span class="n">mlr_diff</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Actual value</th>
      <th>Predicted value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8002</th>
      <td>100</td>
      <td>47.179175</td>
    </tr>
    <tr>
      <th>1432</th>
      <td>85</td>
      <td>37.957549</td>
    </tr>
    <tr>
      <th>1629</th>
      <td>0</td>
      <td>42.175664</td>
    </tr>
    <tr>
      <th>3192</th>
      <td>15</td>
      <td>22.280323</td>
    </tr>
    <tr>
      <th>6754</th>
      <td>40</td>
      <td>53.969793</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1129</th>
      <td>0</td>
      <td>24.757928</td>
    </tr>
    <tr>
      <th>7085</th>
      <td>100</td>
      <td>54.889877</td>
    </tr>
    <tr>
      <th>399</th>
      <td>100</td>
      <td>53.755364</td>
    </tr>
    <tr>
      <th>7839</th>
      <td>70</td>
      <td>52.533166</td>
    </tr>
    <tr>
      <th>4755</th>
      <td>0</td>
      <td>34.049493</td>
    </tr>
  </tbody>
</table>
<p>2070 rows × 2 columns</p>
</div></div></div>
</div>
<br>
<font face="Helvetica" size="3px" color="#323752"> In order to evaluate the model we wiil use <b>metrics</b> from sklearn.
<br><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="n">meanAbErr</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_mlr</span><span class="p">)</span>
<span class="n">meanSqErr</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_mlr</span><span class="p">)</span>
<span class="n">rootMeanSqErr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_mlr</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;R squared: </span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mlr</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean Absolute Error:&#39;</span><span class="p">,</span> <span class="n">meanAbErr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean Square Error:&#39;</span><span class="p">,</span> <span class="n">meanSqErr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Root Mean Square Error:&#39;</span><span class="p">,</span> <span class="n">rootMeanSqErr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>R squared: 12.52
Mean Absolute Error: 32.95629067316155
Mean Square Error: 1384.8373438061174
Root Mean Square Error: 37.21340274425489
</pre></div>
</div>
</div>
</div>
<br>
<font face="Helvetica" size="3px" color="#323752"> Our R Squared value is quite low which shows us how many points fall on the regression line. Also error values are considerably high. Which indicates that this dataset or varibles that we choosed are not appropriate to obtain a good linear regression model.
<br><br>
<font face="Helvetica" size="3px" color="#323752">We can see the data points and linear regression plot of the model below.
<br><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Predicted value&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Actual value&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">mlr_diff</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="kc">None</span><span class="p">);</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Lecture3_74_0.png" src="_images/Lecture3_74_0.png" />
</div>
</div>
</section>
<section id="interactive-linear-regression-widgets">
<h2>5- Interactive Linear Regression Widgets<a class="headerlink" href="#interactive-linear-regression-widgets" title="Permalink to this headline">¶</a></h2>
<br>
<font face="Helvetica" size="3px" color="#323752"> In this part, we use logistic regression widgets. We demonstrate simple logistic regression of single variable using interactive control elements. We will use a single varible for the sake of simplicity of visualization.<br>
<font face="Helvetica" size="3px" color="#323752"> Let's start with importing the widget functions.<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">IntSlider</span><span class="p">,</span> <span class="n">Layout</span><span class="p">,</span> <span class="n">interact_manual</span>
</pre></div>
</div>
</div>
</div>
<br>
<font face="Helvetica" size="3px" color="#323752"> The following widgets  allow the user to introduce noise, change model complexity, and examine the impact of regularization, all on the fly and see the resulting model and predictions instantly.<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N_samples</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">x_min</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
<span class="n">x_max</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">x1</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span><span class="n">x_max</span><span class="p">,</span><span class="n">N_samples</span><span class="o">*</span><span class="mi">5</span><span class="p">)</span>
<span class="n">x</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">N_samples</span><span class="p">)</span>
<span class="n">noise_std</span><span class="o">=</span><span class="mi">1</span>
<span class="n">noise_mean</span><span class="o">=</span><span class="mi">0</span>
<span class="n">noise_magnitude</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">func_gen</span><span class="p">(</span><span class="n">N_samples</span><span class="p">,</span><span class="n">x_min</span><span class="p">,</span><span class="n">x_max</span><span class="p">,</span><span class="n">noise_magnitude</span><span class="p">,</span><span class="n">noise_sd</span><span class="p">,</span><span class="n">noise_mean</span><span class="p">):</span>
    <span class="n">x1</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span><span class="n">x_max</span><span class="p">,</span><span class="n">N_samples</span><span class="o">*</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">x</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">N_samples</span><span class="p">)</span>
    <span class="n">y</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">-</span><span class="mf">0.6</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mf">0.2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="o">+</span><span class="mi">18</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">y1</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">x1</span><span class="o">-</span><span class="mf">0.6</span><span class="o">*</span><span class="n">x1</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mf">0.2</span><span class="o">*</span><span class="n">x1</span><span class="o">**</span><span class="mi">3</span><span class="o">+</span><span class="mi">18</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
    <span class="n">y</span><span class="o">=</span> <span class="n">y</span><span class="o">+</span><span class="n">noise_magnitude</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">noise_mean</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">noise_sd</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">N_samples</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<br>
<font face="Helvetica" size="3px" color="#323752"> The first widget will create data samples with different parameters. User can change the number of the data points, lower and upper limit of the range. Also magnitude, mean, and standard deviation of the noise are the other parameters that can be changed. Constructed data points will be spliting to test and training data in the following widget.<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">=</span><span class="n">interactive</span><span class="p">(</span><span class="n">func_gen</span><span class="p">,</span><span class="n">N_samples</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Low (75 samples)&#39;</span><span class="p">:</span><span class="mi">75</span><span class="p">,</span><span class="s1">&#39;High (250 samples)&#39;</span><span class="p">:</span><span class="mi">250</span><span class="p">},</span><span class="n">x_min</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">x_max</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>
              <span class="n">noise_magnitude</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">noise_sd</span><span class="o">=</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">),</span><span class="n">noise_mean</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">0.5</span><span class="p">))</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "62792a914f6d4e3c81eb53739731574b", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">result</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">PolynomialFeatures</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LassoCV</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">RidgeCV</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">make_pipeline</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lasso_eps</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">lasso_nalpha</span><span class="o">=</span><span class="mi">20</span>
<span class="n">lasso_iter</span><span class="o">=</span><span class="mi">3000</span>
<span class="n">ridge_alphas</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.001</span><span class="p">,</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">func_fit</span><span class="p">(</span><span class="n">model_type</span><span class="p">,</span><span class="n">test_size</span><span class="p">,</span><span class="n">degree</span><span class="p">):</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">test_size</span><span class="o">=</span><span class="n">test_size</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">55</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="n">model_type</span><span class="o">==</span><span class="s1">&#39;Linear regression&#39;</span><span class="p">):</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="p">,</span><span class="n">interaction_only</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> 
                          <span class="n">LinearRegression</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">model_type</span><span class="o">==</span><span class="s1">&#39;LASSO with CV&#39;</span><span class="p">):</span>    
        <span class="n">model</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="p">,</span><span class="n">interaction_only</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> 
                              <span class="n">LassoCV</span><span class="p">(</span><span class="n">eps</span><span class="o">=</span><span class="n">lasso_eps</span><span class="p">,</span><span class="n">n_alphas</span><span class="o">=</span><span class="n">lasso_nalpha</span><span class="p">,</span><span class="n">max_iter</span><span class="o">=</span><span class="n">lasso_iter</span><span class="p">,</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
        
    <span class="k">if</span> <span class="p">(</span><span class="n">model_type</span><span class="o">==</span><span class="s1">&#39;Ridge with CV&#39;</span><span class="p">):</span>    
        <span class="n">model</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="p">,</span><span class="n">interaction_only</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> 
                              <span class="n">RidgeCV</span><span class="p">(</span><span class="n">alphas</span><span class="o">=</span><span class="n">ridge_alphas</span><span class="p">,</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
    
    <span class="n">X_train</span><span class="o">=</span><span class="n">X_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">X_test</span><span class="o">=</span><span class="n">X_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
    
    <span class="n">train_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">))</span>
    <span class="n">train_score</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
    
    <span class="n">test_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>
    <span class="n">test_score</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_test</span><span class="p">)</span>
    
    <span class="n">RMSE_test</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">test_pred</span><span class="o">-</span><span class="n">y_test</span><span class="p">)))</span>
    <span class="n">RMSE_train</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">train_pred</span><span class="o">-</span><span class="n">y_train</span><span class="p">)))</span>
       
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Test set performance</span><span class="se">\n</span><span class="s2">Test score: </span><span class="si">%.3f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">test_score</span><span class="p">),</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;X-test&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;y-test&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_test</span><span class="p">,</span><span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span><span class="n">test_pred</span><span class="p">,</span><span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Actual test values&#39;</span><span class="p">,</span><span class="s1">&#39;Predicted values&#39;</span><span class="p">])</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Training set performance</span><span class="se">\n</span><span class="s2">Training score: </span><span class="si">%.3f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">train_score</span><span class="p">),</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;X-train&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;y-train&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">train_pred</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Actual training values&#39;</span><span class="p">,</span><span class="s1">&#39;Fitted values&#39;</span><span class="p">])</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
       
    <span class="k">return</span> <span class="p">(</span><span class="n">train_score</span><span class="p">,</span><span class="n">test_score</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<br>
<font face="Helvetica" size="3px" color="#323752">Let's talk about the following interactive hyperparameters.The first one choses the model type. The following one is test fraction which determines the size of the test set (fraction of total sample data used in test). Last one is Model complexity (degree of polynomial).<br>
<font face="Helvetica" size="3px" color="#323752"> You can observe the test and training scores by changing these parameters.<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;initial&#39;</span><span class="p">}</span>
<span class="c1"># Continuous_update = False for IntSlider control to stop continuous model evaluation while the slider is being dragged</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">interactive</span><span class="p">(</span><span class="n">func_fit</span><span class="p">,</span><span class="n">model_type</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">RadioButtons</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Linear regression&#39;</span><span class="p">,</span><span class="s1">&#39;LASSO with CV&#39;</span><span class="p">,</span> <span class="s1">&#39;Ridge with CV&#39;</span><span class="p">],</span>
                                                    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Choose Model&quot;</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span>
                                                        <span class="n">layout</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;250px&#39;</span><span class="p">)),</span>
                <span class="n">test_size</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;10</span><span class="si">% o</span><span class="s2">f data&quot;</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span><span class="s2">&quot;20</span><span class="si">% o</span><span class="s2">f data&quot;</span><span class="p">:</span><span class="mf">0.2</span><span class="p">,</span> <span class="s2">&quot;30</span><span class="si">% o</span><span class="s2">f data&quot;</span><span class="p">:</span><span class="mf">0.3</span><span class="p">,</span>
                                                    <span class="s2">&quot;40</span><span class="si">% o</span><span class="s2">f data&quot;</span><span class="p">:</span><span class="mf">0.4</span><span class="p">,</span><span class="s2">&quot;50</span><span class="si">% o</span><span class="s2">f data&quot;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">},</span>
                                          <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Test set size ($X_</span><span class="si">{test}</span><span class="s2">$)&quot;</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">),</span>
               <span class="n">degree</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="nb">max</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">description</span><span class="o">=</span> <span class="s1">&#39;Polynomial($\sum\limits_{i=1}^n a_nx^n$)&#39;</span><span class="p">,</span>
                                       <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span><span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="c1"># Set the height of the control.children[-1] so that the output does not jump and flicker</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">output</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="s1">&#39;450px&#39;</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "4cedea0e68ec49718714cadeb14ac4d8", "version_major": 2, "version_minor": 0}
</script></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="Lecture2.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Lecture 2: Measures for Association in Categorical Data</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="Lecture4.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Lecture 4: Logistic Regression with Binary Dependent Variable and Multiple Independent Variables</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>
